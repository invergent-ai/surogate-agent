<div class="flex w-full mb-4" [class.justify-end]="message.role === 'user'">
  <div
    class="max-w-[85%] rounded-2xl px-4 py-2.5"
    [class.bg-indigo-600]="message.role === 'user'"
    [class.text-white]="message.role === 'user'"
    [class.rounded-br-sm]="message.role === 'user'"
    [class.bg-gray-100]="message.role === 'assistant'"
    [class.text-gray-800]="message.role === 'assistant'"
    [class.rounded-bl-sm]="message.role === 'assistant'"
  >
    @for (block of message.blocks; track $index) {
      @if (isThinking(block)) {
        <app-thinking-block [block]="block" />
      } @else if (isToolCall(block)) {
        <app-tool-call-block [block]="block" />
      } @else if (isText(block)) {
        <p class="text-sm leading-relaxed whitespace-pre-wrap">{{ block.text }}</p>
      } @else if (isError(block)) {
        <p class="text-sm text-red-500">âš  {{ block.text }}</p>
      }
    }

    @if (!message.finalized && message.role === 'assistant') {
      <span class="inline-block w-2 h-4 bg-current animate-pulse ml-0.5 align-middle rounded-sm"></span>
    }
  </div>
</div>
